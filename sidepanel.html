<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="vendor/fontawesome/css/all.min.css">
    <title>Factify</title>
</head>
<body>
  <div id="header">
    <h1>Factify.</h1>
  </div>
  <div id="button-container" style="display: none;">
    <!-- Button for scanning the webpage -->
    <button id="scan-webpage-button" class="api-key-submit">Scan Webpage</button>
    <!-- Button for accessing community hall -->
    <button id="community-hall-button" class="api-key-submit">Community Hall</button>
  </div>
  
  <p id="selection-tip" style="display: none;">Or just select text and hit fact check below the selection.</p>
  
  <!-- API Key Form -->
  <div id="api-key-container" style="display: none;">
    <p class="api-key-message">
      Please enter your Perplexity AI API key to analyze text:
    </p>
    <form id="api-key-form">
      <input type="password" id="api-key-input" placeholder="Enter API Key" required>
      <button type="submit" class="api-key-submit">Submit</button>
    </form>
    <div id="api-key-instructions" style="text-align: center;">
      <ol style="display: inline-block; text-align: left;">
        <li>Visit the <a href="https://www.perplexity.ai" target="_blank" rel="noopener noreferrer">Perplexity website</a> and log in to your account.</li>
        <li>Navigate to the API section in your account settings.</li>
        <li>Generate a new API key and copy it.</li>
        <li>Paste the API key into the input box above.</li>
      </ol>
      <p style="font-size: 0.85em; color: gray; margin-top: 10px;">
        For more info, refer to documentation <a href="https://www.perplexity.ai/help-center/en/articles/10352995-api-settings" target="_blank" rel="noopener noreferrer">here</a>
      </p>
      <p style="font-size: 0.85em; color: gray; margin-top: 10px;">Your key is stored securely and is never passed on to us or anyone else</p> 
    </div>
  </div>
  
  <!-- Loading Indicator -->
  <div id="loading-indicator" style="display: none;">
    <div class="loading-spinner"></div>
    <p>Checking claims...</p>
  </div>
  
  <!-- Error Message -->
  <div id="error-container" style="display: none;">
    <p id="error-message" class="error-text"></p>
  </div>
  
  <!-- Analysis Results -->
  <div id="fact-check-container">
    <div class="charts-container">
      <div class="chart-titles">
        <h3 id="truth-score">Truth Score</h3>
        <h3 id="bias-score">Bias Score</h3>
      </div>
        
      <div class="flex-wrapper">
        <div class="single-chart">
          <svg viewBox="0 0 36 36" class="circular-chart orange" id="truth-chart">
            <path class="circle-bg"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <path class="circle"
              stroke-dasharray="50, 100"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <text x="18" y="20.35" class="percentage">50%</text>
          </svg>
        </div>
        
        <div class="single-chart">
          <svg viewBox="0 0 36 36" class="circular-chart green" id="bias-chart">
            <path class="circle-bg"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <path class="circle"
              stroke-dasharray="60, 100"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <text x="18" y="20.35" class="percentage">60%</text>
          </svg>
        </div>
      </div>
    </div>
    
    <!-- Analysis Reasoning -->
    <div id="reasoning-container" class="content-section">
      <h3 class="section-title">Analysis</h3>
      <div id="reasoning-content" class="content-body"></div>
    </div>
    
    <!-- Citations -->
    <div id="citations-container" class="content-section" style="display: none;">
      <h3 class="section-title">Citations</h3>
      <ol id="citations-list" class="content-body"></ol>
    </div>
    
    <!-- Save to Community Button -->
    <button id="save-to-community" class="save-button">Post to Community Hall</button>
  </div>
  
  <script src="scripts/sidepanel.js"></script>
</body>
</html>